<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Netria - Code Summary | Documentation</title>
    <meta name="description" content="Comprehensive code summary for Netria, explaining how the plugin works in detail.">
    <meta name="keywords" content="Neovim, Netrw, Netria, file explorer, Vim plugin, floating UI, Lua plugin, code summary">
    <meta name="author" content="Abolfazl Mirhajian">
    
    <!-- Open Graph tags for social sharing -->
    <meta property="og:title" content="Netria - Code Summary Documentation">
    <meta property="og:description" content="Understanding how Netria's code works in detail.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://github.com/Mirhajian/netria">
    
    <!-- Twitter Card tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Netria - Code Summary Documentation">
    <meta name="twitter:description" content="Understanding how Netria's code works in detail.">
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    
    <style>
        /* Animated Header Styles */
        .animated-header {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin: 2rem 0;
            color: var(--primary-color);
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1s ease forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .animated-header {
                font-size: 2rem;
                margin: 1.5rem 0;
            }
        }

        /* Add space below nav */
        main.container {
            padding-top: 4rem;
        }

        /* UML Diagram Styles */
        .uml-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 2rem 0;
            padding: 3rem 2rem;
            background: rgba(30, 30, 40, 0.5);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3), 
                        0 0 30px rgba(87, 161, 67, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .uml-diagram::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(ellipse at center, rgba(87, 161, 67, 0.08) 0%, rgba(30, 30, 40, 0) 70%);
            pointer-events: none;
            animation: pulse 4s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        .uml-main-module {
            margin-bottom: 3.5rem;
            position: relative;
            z-index: 5;
        }
        
        .uml-main-module .uml-button {
            background: linear-gradient(to bottom, #4e865f, #3a6e2d);
            min-width: 220px;
            box-shadow: 0 4px 15px rgba(87, 161, 67, 0.25);
            border-color: var(--primary-color);
            animation: glowPulse 3s ease-in-out infinite;
        }
        
        @keyframes glowPulse {
            0%, 100% { box-shadow: 0 4px 15px rgba(87, 161, 67, 0.25); }
            50% { box-shadow: 0 4px 25px rgba(87, 161, 67, 0.4); }
        }
        
        .uml-main-module .uml-button:hover {
            background: linear-gradient(to bottom, #57A143, #4e865f);
            box-shadow: 0 4px 20px rgba(87, 161, 67, 0.35);
            border-color: var(--accent-color);
            animation: none;
        }
        
        .uml-connections {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        .uml-connection {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
        }
        
        .uml-arrow {
            position: absolute;
            border-top: 2px solid var(--primary-color);
            width: 0;
            transform-origin: 0 0;
            z-index: 1;
            filter: drop-shadow(0 0 2px rgba(87, 161, 67, 0.4));
            transition: all 0.3s ease;
        }
        
        .uml-arrow::after {
            content: '';
            position: absolute;
            top: -6px;
            right: -1px;
            width: 12px;
            height: 12px;
            border-top: 2px solid var(--primary-color);
            border-right: 2px solid var(--primary-color);
            transform: rotate(45deg);
            transition: all 0.3s ease;
        }
        
        .uml-modules {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            width: 100%;
            gap: 2rem;
            position: relative;
            z-index: 5;
        }
        
        .uml-button {
            position: relative;
            display: block;
            padding: 1rem 1.5rem;
            background: linear-gradient(to bottom, #3d3f44, #2d2d35);
            color: #fff;
            border: 1px solid var(--primary-color);
            border-radius: 6px;
            text-align: center;
            text-decoration: none;
            font-weight: 500;
            min-width: 180px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .uml-button:hover {
            background: linear-gradient(to bottom, #4a4a5a, #44444f);
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(87, 161, 67, 0.2);
            border-color: var(--accent-color);
            z-index: 10;
        }
        
        .uml-button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .uml-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #27272f;
            color: #fff;
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 10;
            width: max-content;
            max-width: 200px;
            margin-bottom: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            border-left: 3px solid var(--primary-color);
        }
        
        .uml-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-width: 5px;
            border-style: solid;
            border-color: #27272f transparent transparent transparent;
        }
        
        .uml-button:hover .uml-tooltip {
            opacity: 1;
            visibility: visible;
        }
        
        /* Module highlight effect */
        @keyframes highlightPulse {
            0% { box-shadow: 0 0 0 0 rgba(87, 161, 67, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(87, 161, 67, 0); }
            100% { box-shadow: 0 0 0 0 rgba(87, 161, 67, 0); }
        }
        
        .module-highlight {
            animation: highlightPulse 1.5s 1;
            border-color: var(--primary-color) !important;
            background: rgba(40, 44, 60, 0.8) !important;
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .uml-modules {
                flex-direction: column;
                align-items: center;
                gap: 2.5rem;
            }
            
            .uml-main-module {
                margin-bottom: 3rem;
            }
            
            .uml-button {
                margin-bottom: 0;
                width: 80%;
            }
            
            /* Mobile arrow adjustments */
            .uml-arrow {
                top: 115px !important;
                left: 50% !important;
                width: 2px !important;
                height: 35px !important;
                border-top: none !important;
                border-left: 2px solid var(--accent-color) !important;
                transform: none !important;
            }
            
            .uml-arrow::after {
                top: auto !important;
                right: auto !important;
                bottom: -1px !important;
                left: -5px !important;
                transform: rotate(135deg) !important;
            }
            
            .uml-modules .uml-button:nth-child(1) .mobile-arrow,
            .uml-modules .uml-button:nth-child(2) .mobile-arrow,
            .uml-modules .uml-button:nth-child(3) .mobile-arrow,
            .uml-modules .uml-button:nth-child(4) .mobile-arrow,
            .uml-modules .uml-button:nth-child(5) .mobile-arrow {
                display: block !important;
                height: 30px !important;
                top: -35px !important;
            }
        }
    </style>
</head>
<body class="dark-mode">
    <nav>
        <div class="container">
            <div class="menu-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M3 12h18M3 6h18M3 18h18"/>
                </svg>
            </div>
            <ul>
                <li><a href="#module-diagram">Module Diagram</a></li>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#operational-flow">Operational Flow</a></li>
                <li><a href="#technical-challenges">Technical Challenges</a></li>
                <li><a href="#extensibility">Extensibility</a></li>
            </ul>
            <a href="https://github.com/Mirhajian" target="_blank" rel="noopener noreferrer" class="github-profile" onclick="event.preventDefault(); window.open(this.href, '_blank');">
                <img src="https://github.com/Mirhajian.png" alt="Abolfazl Mirhajian's GitHub Profile">
            </a>
        </div>
    </nav>

    <div class="menu-overlay"></div>
    <div class="sliding-menu">
        <div class="menu-close">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
        </div>
        <ul>
            <li><a href="https://github.com/Mirhajian" target="_blank">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 16px; height: 16px; margin-right: 8px; vertical-align: middle;">
                    <path d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.865 8.17 6.839 9.49.5.092.682-.217.682-.482 0-.237-.008-.866-.013-1.7-2.782.604-3.369-1.34-3.369-1.34-.454-1.156-1.11-1.464-1.11-1.464-.908-.62.069-.608.069-.608 1.003.07 1.531 1.03 1.531 1.03.892 1.529 2.341 1.087 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.11-4.555-4.943 0-1.091.39-1.984 1.029-2.683-.103-.253-.446-1.27.098-2.647 0 0 .84-.269 2.75 1.025A9.578 9.578 0 0112 6.836c.85.004 1.705.114 2.504.336 1.909-1.294 2.747-1.025 2.747-1.025.546 1.377.203 2.394.1 2.647.64.699 1.028 1.592 1.028 2.683 0 3.842-2.339 4.687-4.566 4.935.359.309.678.919.678 1.852 0 1.336-.012 2.415-.012 2.743 0 .267.18.578.688.48C19.138 20.167 22 16.418 22 12c0-5.523-4.477-10-10-10z"/>
                </svg>
                GitHub Profile
            </a></li>
            <li><a href="index.html">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 16px; height: 16px; margin-right: 8px; vertical-align: middle;">
                    <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                </svg>
                Main Documentation
            </a></li>
            <li><a href="code-structure.html">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" style="width: 16px; height: 16px; margin-right: 8px; vertical-align: middle;">
                    <path d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"/>
                </svg>
                Code Structure
            </a></li>
        </ul>
    </div>

    <main class="container">
        <h1 class="animated-header">How Netria works in detail</h1>

        <section id="module-diagram" class="section">
            <h2>Module Diagram</h2>
            <p>
                This interactive diagram shows the main components of Netria. Click on any module to navigate to its detailed explanation.
            </p>

            <div class="uml-diagram">
                <div class="uml-main-module">
                    <a href="#core-architecture" class="uml-button">
                        Netria Core
                        <span class="uml-tooltip">Main entry point and plugin initialization</span>
                    </a>
                </div>
                
                <div class="uml-connections">
                    <!-- Dynamic connections will be drawn by JavaScript -->
                </div>
                
                <div class="uml-modules">
                    <a href="#ui-module" class="uml-button" data-module="ui">
                        UI Module
                        <span class="uml-tooltip">Floating window creation and management</span>
                        <div class="uml-arrow mobile-arrow" style="display: none;"></div>
                    </a>
                    <a href="#config-module" class="uml-button" data-module="config">
                        Config Module
                        <span class="uml-tooltip">Configuration handling and defaults</span>
                        <div class="uml-arrow mobile-arrow" style="display: none;"></div>
                    </a>
                    <a href="#netrw-module" class="uml-button" data-module="netrw">
                        Netrw Module
                        <span class="uml-tooltip">Integration with Netrw file explorer</span>
                        <div class="uml-arrow mobile-arrow" style="display: none;"></div>
                    </a>
                    <a href="#banner-module" class="uml-button" data-module="banner">
                        Banner Module
                        <span class="uml-tooltip">Custom ASCII banner implementation</span>
                        <div class="uml-arrow mobile-arrow" style="display: none;"></div>
                    </a>
                    <a href="#state-module" class="uml-button" data-module="state">
                        State Module
                        <span class="uml-tooltip">Internal state tracking and management</span>
                        <div class="uml-arrow mobile-arrow" style="display: none;"></div>
                    </a>
                </div>
            </div>
        </section>

        <section id="how-it-works" class="section">
            <h2>How Netria Works</h2>
            <p>
                At its core, Netria is an enhancement layer for Neovim's built-in Netrw file explorer. Rather than replacing Netrw 
                entirely, Netria creates a modern, floating interface around it while preserving all of Netrw's original functionality.
                Here's a detailed explanation of how this is accomplished:
            </p>

            <div class="module-card" id="core-architecture">
                <h3>1. The Enhancement Approach</h3>
                <p>
                    Instead of reimplementing file explorer functionality from scratch, Netria takes advantage of Netrw's maturity
                    and reliability while addressing its main drawback - the basic user interface. This approach has several advantages:
                </p>
                <ul>
                    <li>Users can continue using the Netrw commands and keybindings they're already familiar with</li>
                    <li>All Netrw features work as expected, including file operations, filtering, and sorting</li>
                    <li>The implementation is lighter and more maintainable than a complete replacement</li>
                    <li>No external dependencies are needed beyond what's built into Neovim</li>
                </ul>
            </div>

            <div class="module-card" id="ui-module">
                <h3>2. Floating Window Implementation</h3>
                <p>
                    The core of Netria's visual enhancement is the floating window system. When you open Netria:
                </p>
                <ol>
                    <li>A new buffer is created to hold the Netrw content</li>
                    <li>A floating window is created with customizable dimensions, position, and border style</li>
                    <li>Netrw's Explore command is executed in this buffer to show the directory contents</li>
                    <li>The plugin applies visual enhancements like line numbers and the custom banner</li>
                    <li>Netrw commands run in this context, with Netria maintaining the floating window appearance</li>
                </ol>
                <p>
                    The floating window provides a focused view of the file system that doesn't disrupt your workspace layout.
                    It can be toggled on and off quickly, making it ideal for fast file navigation without cluttering your screen.
                </p>
            </div>

            <div class="module-card" id="banner-module">
                <h3>3. Custom Banner Integration</h3>
                <p>
                    One of Netria's distinctive features is the custom ASCII art banner at the top of the explorer. This isn't 
                    just a decorative element - it's a technically sophisticated component:
                </p>
                <ul>
                    <li>The banner is carefully inserted into the Netrw buffer using buffer manipulation techniques</li>
                    <li>It's centered based on the current window width to always look balanced</li>
                    <li>Special line number signs are created to handle the banner lines properly</li>
                    <li>The banner is re-added whenever Netrw refreshes its display</li>
                    <li>A series of safety checks prevent banner duplication or buffer corruption</li>
                </ul>
            </div>

            <div class="module-card" id="netrw-module">
                <h3>4. Netrw Integration</h3>
                <p>
                    The integration with Netrw is achieved through a combination of:
                </p>
                <ul>
                    <li><strong>Global variables:</strong> Setting Netrw options like <code>g:netrw_banner</code> and <code>g:netrw_liststyle</code></li>
                    <li><strong>Autocommands:</strong> Hooking into Netrw events like <code>NetrwBrowseChgDir</code></li>
                    <li><strong>Function hooks:</strong> Using Netrw's <code>g:Netrw_funcref</code> for refresh notifications</li>
                    <li><strong>Buffer tracking:</strong> Identifying and managing Netrw buffers created by the plugin</li>
                </ul>
                <p>
                    This integration is carefully designed to enhance Netrw without breaking any of its existing functionality.
                </p>
            </div>

            <div class="module-card" id="state-module">
                <h3>5. State Management</h3>
                <p>
                    Tracking state is crucial for Netria's operation. The plugin maintains information about:
                </p>
                <ul>
                    <li>The current floating window ID</li>
                    <li>The current Netrw buffer ID</li>
                    <li>The directory currently being displayed</li>
                    <li>Whether the plugin was initialized with a directory argument</li>
                    <li>Which buffers have had banners added to them</li>
                    <li>Whether certain operations are in progress (to prevent re-entrancy issues)</li>
                </ul>
                <p>
                    This state management allows Netria to maintain context as the user navigates through directories
                    and toggle the explorer on and off without losing their place.
                </p>
            </div>
        </section>

        <section id="operational-flow" class="section">
            <h2>Operational Flow</h2>
            <p>
                Let's examine the detailed operational flow of Netria during common usage scenarios:
            </p>

            <div class="module-card" id="config-module">
                <h3>Plugin Initialization</h3>
                <h4>When loading your Neovim configuration:</h4>
                <ol>
                    <li>The Neovim runtime loads <code>plugin/netria.lua</code>, which simply returns <code>require('netria')</code></li>
                    <li>When <code>require('netria').setup(opts)</code> is called in your config:
                        <ul>
                            <li>The config module merges user options with default values</li>
                            <li>The state module initializes its tracking variables</li>
                            <li>Netrw hooks are established to integrate with Netrw events</li>
                            <li>User commands (<code>:NetriaOpen</code>, <code>:NetriaToggle</code>, etc.) are registered</li>
                            <li>Event listeners are set up for various Neovim events</li>
                        </ul>
                    </li>
                    <li>A <code>VimEnter</code> autocmd is created to handle startup with a directory argument</li>
                </ol>
            </div>

            <div class="module-card">
                <h3>Opening Netria</h3>
                <h4>When <code>:NetriaOpen</code> is executed:</h4>
                <ol>
                    <li>The UI module creates a new buffer for Netrw content</li>
                    <li>Window dimensions are calculated based on configuration:
                        <ul>
                            <li>Width and height as percentage of screen size</li>
                            <li>Position (center, left, or right) as specified</li>
                        </ul>
                    </li>
                    <li>A floating window is created with these dimensions and the configured border style</li>
                    <li>The state module records the window and buffer IDs</li>
                    <li>Netrw settings are configured (hide banner, set list style, etc.)</li>
                    <li>The Netrw <code>Explore</code> command is executed in this buffer</li>
                    <li>After a short delay (to let Netrw initialize):
                        <ul>
                            <li>The custom banner is added to the top of the buffer</li>
                            <li>Special line number signs are created for banner lines</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="module-card">
                <h3>Directory Navigation</h3>
                <h4>When navigating directories in Netria:</h4>
                <ol>
                    <li>User interactions (like pressing Enter on a directory) trigger standard Netrw behavior</li>
                    <li>Netrw fires the <code>NetrwBrowseChgDir</code> event</li>
                    <li>Netria's hook (<code>_G.Netria_UpdateCurrentDir</code>) is triggered</li>
                    <li>The current directory is updated in Netria's state</li>
                    <li>The custom banner is re-added to maintain the enhanced appearance</li>
                    <li>Event handlers ensure window settings are preserved</li>
                </ol>
            </div>

            <div class="module-card">
                <h3>File Operations</h3>
                <h4>When performing file operations (create, rename, delete):</h4>
                <ol>
                    <li>Standard Netrw commands are used (%, d, D, R, etc.)</li>
                    <li>Netrw performs the actual filesystem operations</li>
                    <li>When Netrw refreshes the display, Netria's hooks are triggered</li>
                    <li>The custom banner and other visual enhancements are reapplied</li>
                </ol>
                <p>
                    This maintains a consistent interface while leveraging Netrw's file operation capabilities.
                </p>
            </div>

            <div class="module-card">
                <h3>Opening Files</h3>
                <h4>When opening a file from Netria:</h4>
                <ol>
                    <li>Netrw handles the file opening as usual</li>
                    <li>If configured, Netria applies the line number settings to the file buffer</li>
                    <li>The Netria floating window remains open for quick navigation</li>
                    <li>The state module tracks the opened file buffer for context</li>
                </ol>
            </div>

            <div class="module-card">
                <h3>Toggling and Closing</h3>
                <h4>When toggling or closing Netria:</h4>
                <ol>
                    <li>The UI module checks if the Netria window is currently valid</li>
                    <li>If it exists, the window is closed and state is updated</li>
                    <li>If it doesn't exist, a new window is opened (for toggle)</li>
                    <li>The previous directory context is restored when reopening</li>
                </ol>
            </div>

            <div class="note">
                <p><strong>Note:</strong> Throughout these operations, Netria maintains a delicate balance - enhancing Netrw's appearance without interfering with its functionality.</p>
            </div>
        </section>

        <section id="technical-challenges" class="section">
            <h2>Technical Challenges</h2>
            <p>
                Netria's implementation addresses several technical challenges inherent in enhancing Netrw:
            </p>
            
            <div class="module-card" id="events-module">
                <h3>Event Coordination</h3>
                <p>
                    Coordinating with Neovim and Netrw events requires careful event handling:
                </p>
                <ul>
                    <li>Setting up appropriate autocmds for various Neovim events</li>
                    <li>Integrating with Netrw-specific events</li>
                    <li>Preventing event cascades and infinite loops</li>
                    <li>Managing timing issues with deferred function calls</li>
                </ul>
            </div>
            
            <div class="module-card">
                <h3>Banner Persistence</h3>
                <p>
                    One of the most significant challenges is maintaining the custom banner through Netrw's operations.
                    Netrw regularly refreshes its display, which can remove custom additions. Netria solves this through:
                </p>
                <ul>
                    <li>Carefully timed banner insertion after Netrw initialization</li>
                    <li>Hooks into Netrw's refresh events</li>
                    <li>Detection of banner presence to avoid duplication</li>
                    <li>Error handling to prevent buffer corruption</li>
                </ul>
            </div>
            
            <div class="module-card">
                <h3>Window Management</h3>
                <p>
                    Managing the floating window requires careful handling of Neovim's window API:
                </p>
                <ul>
                    <li>Calculating appropriate window dimensions based on screen size</li>
                    <li>Positioning the window according to user preferences</li>
                    <li>Ensuring window settings persist through buffer changes</li>
                    <li>Detecting window validity before operations</li>
                </ul>
            </div>
            
            <div class="module-card">
                <h3>Buffer Management</h3>
                <p>
                    Safely manipulating buffers requires attention to detail:
                </p>
                <ul>
                    <li>Temporarily changing buffer properties (modifiable, readonly)</li>
                    <li>Restoring buffer state after modifications</li>
                    <li>Tracking which buffers are associated with Netria</li>
                    <li>Handling cursor position after buffer changes</li>
                </ul>
            </div>
            
            <div class="tip">
                <p><strong>Tip for developers:</strong> The careful handling of these technical challenges makes Netria an excellent 
                study in how to enhance existing Neovim plugins without replacing them entirely.</p>
            </div>
        </section>

        <section id="extensibility" class="section">
            <h2>Extensibility</h2>
            <p>
                Netria's modular architecture makes it highly extensible. Here are some ways the code could be extended:
            </p>
            
            <div class="module-card">
                <h3>Adding New Features</h3>
                <p>New features can be added by:</p>
                <ul>
                    <li>Creating new modules or extending existing ones</li>
                    <li>Adding new configuration options in <code>config.lua</code></li>
                    <li>Registering additional commands in <code>commands.lua</code></li>
                    <li>Creating new event handlers in <code>events.lua</code></li>
                </ul>
            </div>
            
            <div class="module-card">
                <h3>Example Extension: File Previews</h3>
                <p>
                    A file preview feature could be implemented by:
                </p>
                <ol>
                    <li>Creating a new module <code>preview.lua</code> with preview functionality</li>
                    <li>Adding preview configuration options to <code>config.lua</code></li>
                    <li>Hooking into Netrw's cursor movement events in <code>events.lua</code></li>
                    <li>Creating a secondary floating window for the preview</li>
                    <li>Updating the preview content as the user navigates files</li>
                </ol>
            </div>
            
            <div class="module-card">
                <h3>Integration with Other Plugins</h3>
                <p>
                    Netria's code structure allows for integration with other plugins:
                </p>
                <ul>
                    <li>Adding hooks to notify other plugins of file selection</li>
                    <li>Creating integration modules for specific plugins</li>
                    <li>Exposing an API for other plugins to interact with Netria</li>
                </ul>
            </div>
        </section>

        <div class="tip">
            <p>
                <strong>Developer tip:</strong> For a more detailed understanding of specific modules and their interactions, 
                check out the <a href="code-structure.html">Code Structure</a> page, which breaks down each module's responsibility 
                and provides code examples.
            </p>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>
                Netria is open source software. Visit the 
                <a href="https://github.com/Mirhajian/netria" target="_blank">GitHub repository</a> 
                to contribute or report issues.
            </p>
            <p>
                Created by <a href="https://github.com/Mirhajian" target="_blank">Abolfazl Mirhajian</a>
            </p>
            <p>
                Licensed under the MIT License - see the 
                <a href="https://github.com/Mirhajian/netria/blob/main/LICENSE" target="_blank">LICENSE</a> 
                file for details.
            </p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script>
        // Menu toggle functionality
        const menuIcon = document.querySelector('.menu-icon');
        const menuClose = document.querySelector('.menu-close');
        const slidingMenu = document.querySelector('.sliding-menu');
        const menuOverlay = document.querySelector('.menu-overlay');

        menuIcon.addEventListener('click', () => {
            slidingMenu.classList.toggle('active');
            menuOverlay.classList.toggle('active');
        });

        menuClose.addEventListener('click', () => {
            slidingMenu.classList.remove('active');
            menuOverlay.classList.remove('active');
        });

        menuOverlay.addEventListener('click', () => {
            slidingMenu.classList.remove('active');
            menuOverlay.classList.remove('active');
        });

        // Close menu when clicking a link
        document.querySelectorAll('.sliding-menu a').forEach(link => {
            link.addEventListener('click', () => {
                slidingMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
            });
        });
        
        // UML Diagram Connection Drawing
        document.addEventListener('DOMContentLoaded', () => {
            const umlDiagram = document.querySelector('.uml-diagram');
            const mainModule = document.querySelector('.uml-main-module .uml-button');
            const moduleButtons = document.querySelectorAll('.uml-modules .uml-button');
            const connectionsContainer = document.querySelector('.uml-connections');
            
            if (!umlDiagram || !mainModule || !moduleButtons.length) return;
            
            // Function to calculate and draw connections
            function drawConnections() {
                // Clear existing connections
                connectionsContainer.innerHTML = '';
                
                // Get main module position
                const mainRect = mainModule.getBoundingClientRect();
                const diagramRect = umlDiagram.getBoundingClientRect();
                
                // Calculate main module center relative to diagram
                const mainCenterX = mainRect.left + mainRect.width / 2 - diagramRect.left;
                const mainCenterY = mainRect.top + mainRect.height - diagramRect.top;
                
                // For each target module, draw a connection
                moduleButtons.forEach((module, index) => {
                    const moduleRect = module.getBoundingClientRect();
                    
                    // Calculate target module top-center relative to diagram
                    const moduleCenterX = moduleRect.left + moduleRect.width / 2 - diagramRect.left;
                    const moduleTopY = moduleRect.top - diagramRect.top;
                    
                    // Create connection element
                    const connection = document.createElement('div');
                    connection.className = 'uml-connection';
                    
                    // Create arrow element
                    const arrow = document.createElement('div');
                    arrow.className = 'uml-arrow';
                    
                    // Calculate distance and angle
                    const dx = moduleCenterX - mainCenterX;
                    const dy = moduleTopY - mainCenterY;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx);
                    
                    // Set arrow position and transform
                    arrow.style.top = `${mainCenterY}px`;
                    arrow.style.left = `${mainCenterX}px`;
                    arrow.style.width = `${distance}px`;
                    arrow.style.transform = `rotate(${angle}rad)`;
                    
                    // Add data attributes for animation
                    arrow.dataset.index = index;
                    arrow.style.opacity = '0';
                    arrow.style.transition = 'opacity 0.3s ease, width 0.5s ease, transform 0.5s ease';
                    
                    // Add to connection container
                    connection.appendChild(arrow);
                    connectionsContainer.appendChild(connection);
                    
                    // Store module identifier on the arrow element
                    arrow.dataset.module = module.dataset.module;
                    
                    // Add hover effect for corresponding arrows
                    module.addEventListener('mouseenter', () => {
                        document.querySelectorAll(`.uml-arrow[data-module="${module.dataset.module}"]`).forEach(arr => {
                            arr.style.borderColor = 'var(--accent-color)';
                            arr.style.borderWidth = '3px';
                            arr.style.zIndex = '10';
                            arr.style.filter = 'drop-shadow(0 0 5px rgba(87, 161, 67, 0.6))';
                        });
                        
                        // Also highlight after pseudo-element
                        const style = document.createElement('style');
                        style.className = 'hover-style';
                        style.textContent = `.uml-arrow[data-module="${module.dataset.module}"]::after { border-color: var(--accent-color); border-width: 3px; }`;
                        document.head.appendChild(style);
                    });
                    
                    module.addEventListener('mouseleave', () => {
                        document.querySelectorAll(`.uml-arrow[data-module="${module.dataset.module}"]`).forEach(arr => {
                            arr.style.borderColor = '';
                            arr.style.borderWidth = '';
                            arr.style.zIndex = '';
                            arr.style.filter = '';
                        });
                        
                        // Remove the added style
                        document.querySelectorAll('.hover-style').forEach(style => style.remove());
                    });
                });
                
                // Animate arrows appearing in sequence with grow effect
                setTimeout(() => {
                    document.querySelectorAll('.uml-arrow').forEach((arrow, index) => {
                        const originalWidth = arrow.style.width;
                        const originalTransform = arrow.style.transform;
                        
                        // Start with zero width
                        arrow.style.width = '0px';
                        arrow.style.opacity = '1';
                        
                        // Animate growing
                        setTimeout(() => {
                            arrow.style.width = originalWidth;
                            arrow.style.transform = originalTransform;
                        }, 120 * index);
                    });
                }, 300);
            }
            
            // Draw connections initially
            drawConnections();
            
            // Redraw on window resize
            window.addEventListener('resize', () => {
                // Only redraw if not on mobile
                if (window.innerWidth > 768) {
                    drawConnections();
                }
            });
            
            // Check for mobile view and handle accordingly
            function checkMobileView() {
                const isMobile = window.innerWidth <= 768;
                
                // Toggle display of connection elements
                connectionsContainer.style.display = isMobile ? 'none' : 'block';
                
                // Show or hide mobile arrows
                document.querySelectorAll('.mobile-arrow').forEach(arrow => {
                    arrow.style.display = isMobile ? 'block' : 'none';
                });
                
                if (isMobile) {
                    // Clear desktop connections
                    connectionsContainer.innerHTML = '';
                }
            }
            
            // Initial check
            checkMobileView();
            
            // Update on resize
            window.addEventListener('resize', checkMobileView);
        });

        // Improved smooth scroll for all internal links
        document.addEventListener('DOMContentLoaded', () => {
            const smoothScrollLinks = document.querySelectorAll('a[href^="#"]');
            
            smoothScrollLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        // Add highlight effect to target element
                        const highlightClass = 'module-highlight';
                        
                        // Scroll to target with smooth behavior
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        // Highlight target briefly
                        targetElement.classList.add(highlightClass);
                        setTimeout(() => {
                            targetElement.classList.remove(highlightClass);
                        }, 1500);
                    }
                });
            });
        });

        // Smooth scroll for navigation links
        document.querySelectorAll('nav a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId.includes('#')) {
                    const hashIndex = targetId.indexOf('#');
                    const hash = targetId.substring(hashIndex);
                    if (targetId.startsWith('#')) {
                        const targetElement = document.querySelector(hash);
                        if (targetElement) {
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    } else {
                        window.location.href = targetId;
                    }
                } else {
                    window.location.href = targetId;
                }
            });
        });
    </script>
</body>
</html> 